#include <arch/internal/IDT.h>
#include <arch/internal/GDT.h>
#include <string.h>

using namespace Arch;

struct idt_entry idt[I86_IDT_MAX_ENTRY_COUNT];
struct idt_ptr ip;


void Arch::idt_flush()
{
	asm("lidt	%0" : "=m" (ip));
}

void Arch::idt_set_gate(uint8_t i, uint32_t base, uint16_t sel, uint8_t flags)
{
	idt[i].offset_low = base & 0xFFFF;
	idt[i].offset_high = (base >> 16) & 0xFFFF;
	
	idt[i].selector = sel;
	idt[i].zero = 0;
	
	idt[i].type_attr = flags;
}

void Arch::idt_setup(void)
{
    memset(&idt, 0, sizeof(struct idt_entry) * I86_IDT_MAX_ENTRY_COUNT);
	
	idt_set_gate(0, (uint32_t)exception0, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
	idt_set_gate(1, (uint32_t)exception1, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
	idt_set_gate(2, (uint32_t)exception2, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
	idt_set_gate(3, (uint32_t)exception3, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
	idt_set_gate(4, (uint32_t)exception4, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
	idt_set_gate(5, (uint32_t)exception5, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
	idt_set_gate(6, (uint32_t)exception6, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
	idt_set_gate(7, (uint32_t)exception7, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
	idt_set_gate(8, (uint32_t)exception8, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
	idt_set_gate(9, (uint32_t)exception9, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
	idt_set_gate(10, (uint32_t)exception10, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
	idt_set_gate(11, (uint32_t)exception11, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
	idt_set_gate(12, (uint32_t)exception12, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
	idt_set_gate(13, (uint32_t)exception13, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
	idt_set_gate(14, (uint32_t)exception14, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
	idt_set_gate(15, (uint32_t)exception15, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
	idt_set_gate(16, (uint32_t)exception16, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
	idt_set_gate(17, (uint32_t)exception17, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
	idt_set_gate(18, (uint32_t)exception18, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
	idt_set_gate(19, (uint32_t)exception19, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
	idt_set_gate(20, (uint32_t)exception20, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
	idt_set_gate(21, (uint32_t)exception21, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
	idt_set_gate(22, (uint32_t)exception22, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
	idt_set_gate(23, (uint32_t)exception23, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
	idt_set_gate(24, (uint32_t)exception24, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
	idt_set_gate(25, (uint32_t)exception25, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
	idt_set_gate(26, (uint32_t)exception26, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
	idt_set_gate(27, (uint32_t)exception27, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
	idt_set_gate(28, (uint32_t)exception28, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
	idt_set_gate(29, (uint32_t)exception29, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
	idt_set_gate(30, (uint32_t)exception30, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
	idt_set_gate(31, (uint32_t)exception31, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
	
	
	
	idt_set_gate(32, (uint32_t)irq32, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
	idt_set_gate(33, (uint32_t)irq33, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
	idt_set_gate(34, (uint32_t)irq34, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
	idt_set_gate(35, (uint32_t)irq35, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
	idt_set_gate(36, (uint32_t)irq36, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
	idt_set_gate(37, (uint32_t)irq37, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
	idt_set_gate(38, (uint32_t)irq38, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
	idt_set_gate(39, (uint32_t)irq39, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
	idt_set_gate(40, (uint32_t)irq40, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
	idt_set_gate(41, (uint32_t)irq41, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
	idt_set_gate(42, (uint32_t)irq42, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
	idt_set_gate(43, (uint32_t)irq43, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
	idt_set_gate(44, (uint32_t)irq44, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
	idt_set_gate(45, (uint32_t)irq45, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
	idt_set_gate(46, (uint32_t)irq46, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
	idt_set_gate(47, (uint32_t)irq47, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
	idt_set_gate(48, (uint32_t)irq48, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
	idt_set_gate(49, (uint32_t)irq49, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
	idt_set_gate(50, (uint32_t)irq50, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
	idt_set_gate(51, (uint32_t)irq51, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
	idt_set_gate(52, (uint32_t)irq52, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
	idt_set_gate(53, (uint32_t)irq53, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
	idt_set_gate(54, (uint32_t)irq54, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
	idt_set_gate(55, (uint32_t)irq55, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
	idt_set_gate(56, (uint32_t)irq56, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
	idt_set_gate(57, (uint32_t)irq57, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
	idt_set_gate(58, (uint32_t)irq58, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
	idt_set_gate(59, (uint32_t)irq59, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
	idt_set_gate(60, (uint32_t)irq60, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
	idt_set_gate(61, (uint32_t)irq61, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(62, (uint32_t)irq62, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(63, (uint32_t)irq63, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(64, (uint32_t)irq64, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(65, (uint32_t)irq65, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(66, (uint32_t)irq66, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(67, (uint32_t)irq67, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(68, (uint32_t)irq68, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(69, (uint32_t)irq69, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(70, (uint32_t)irq70, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(71, (uint32_t)irq71, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(72, (uint32_t)irq72, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(73, (uint32_t)irq73, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(74, (uint32_t)irq74, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(75, (uint32_t)irq75, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(76, (uint32_t)irq76, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(77, (uint32_t)irq77, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(78, (uint32_t)irq78, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(79, (uint32_t)irq79, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(80, (uint32_t)irq80, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(81, (uint32_t)irq81, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(82, (uint32_t)irq82, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(83, (uint32_t)irq83, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(84, (uint32_t)irq84, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(85, (uint32_t)irq85, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(86, (uint32_t)irq86, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(87, (uint32_t)irq87, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(88, (uint32_t)irq88, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(89, (uint32_t)irq89, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(90, (uint32_t)irq90, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(91, (uint32_t)irq91, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(92, (uint32_t)irq92, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(93, (uint32_t)irq93, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(94, (uint32_t)irq94, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(95, (uint32_t)irq95, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(96, (uint32_t)irq96, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(97, (uint32_t)irq97, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(98, (uint32_t)irq98, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(99, (uint32_t)irq99, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(100, (uint32_t)irq100, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(101, (uint32_t)irq101, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(102, (uint32_t)irq102, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(103, (uint32_t)irq103, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(104, (uint32_t)irq104, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(105, (uint32_t)irq105, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(106, (uint32_t)irq106, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(107, (uint32_t)irq107, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(108, (uint32_t)irq108, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(109, (uint32_t)irq109, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(110, (uint32_t)irq110, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(111, (uint32_t)irq111, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(112, (uint32_t)irq112, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(113, (uint32_t)irq113, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(114, (uint32_t)irq114, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(115, (uint32_t)irq115, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(116, (uint32_t)irq116, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(117, (uint32_t)irq117, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(118, (uint32_t)irq118, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(119, (uint32_t)irq119, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(120, (uint32_t)irq120, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(121, (uint32_t)irq121, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(122, (uint32_t)irq122, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(123, (uint32_t)irq123, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(124, (uint32_t)irq124, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(125, (uint32_t)irq125, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(126, (uint32_t)irq126, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(127, (uint32_t)irq127, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(128, (uint32_t)irq128, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(129, (uint32_t)irq129, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(130, (uint32_t)irq130, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(131, (uint32_t)irq131, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(132, (uint32_t)irq132, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(133, (uint32_t)irq133, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(134, (uint32_t)irq134, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(135, (uint32_t)irq135, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(136, (uint32_t)irq136, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(137, (uint32_t)irq137, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(138, (uint32_t)irq138, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(139, (uint32_t)irq139, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(140, (uint32_t)irq140, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(141, (uint32_t)irq141, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(142, (uint32_t)irq142, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(143, (uint32_t)irq143, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(144, (uint32_t)irq144, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(145, (uint32_t)irq145, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(146, (uint32_t)irq146, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(147, (uint32_t)irq147, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(148, (uint32_t)irq148, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(149, (uint32_t)irq149, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(150, (uint32_t)irq150, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(151, (uint32_t)irq151, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(152, (uint32_t)irq152, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(153, (uint32_t)irq153, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(154, (uint32_t)irq154, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(155, (uint32_t)irq155, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(156, (uint32_t)irq156, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(157, (uint32_t)irq157, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(158, (uint32_t)irq158, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(159, (uint32_t)irq159, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(160, (uint32_t)irq160, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(161, (uint32_t)irq161, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(162, (uint32_t)irq162, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(163, (uint32_t)irq163, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(164, (uint32_t)irq164, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(165, (uint32_t)irq165, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(166, (uint32_t)irq166, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(167, (uint32_t)irq167, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(168, (uint32_t)irq168, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(169, (uint32_t)irq169, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(170, (uint32_t)irq170, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(171, (uint32_t)irq171, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(172, (uint32_t)irq172, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(173, (uint32_t)irq173, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(174, (uint32_t)irq174, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(175, (uint32_t)irq175, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(176, (uint32_t)irq176, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(177, (uint32_t)irq177, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(178, (uint32_t)irq178, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(179, (uint32_t)irq179, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(180, (uint32_t)irq180, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(181, (uint32_t)irq181, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(182, (uint32_t)irq182, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(183, (uint32_t)irq183, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(184, (uint32_t)irq184, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(185, (uint32_t)irq185, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(186, (uint32_t)irq186, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(187, (uint32_t)irq187, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(188, (uint32_t)irq188, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(189, (uint32_t)irq189, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(190, (uint32_t)irq190, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(191, (uint32_t)irq191, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(192, (uint32_t)irq192, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(193, (uint32_t)irq193, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(194, (uint32_t)irq194, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(195, (uint32_t)irq195, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(196, (uint32_t)irq196, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(197, (uint32_t)irq197, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(198, (uint32_t)irq198, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(199, (uint32_t)irq199, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(200, (uint32_t)irq200, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(201, (uint32_t)irq201, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(202, (uint32_t)irq202, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(203, (uint32_t)irq203, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(204, (uint32_t)irq204, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(205, (uint32_t)irq205, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(206, (uint32_t)irq206, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(207, (uint32_t)irq207, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(208, (uint32_t)irq208, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(209, (uint32_t)irq209, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(210, (uint32_t)irq210, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(211, (uint32_t)irq211, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(212, (uint32_t)irq212, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(213, (uint32_t)irq213, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(214, (uint32_t)irq214, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(215, (uint32_t)irq215, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(216, (uint32_t)irq216, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(217, (uint32_t)irq217, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(218, (uint32_t)irq218, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(219, (uint32_t)irq219, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(220, (uint32_t)irq220, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(221, (uint32_t)irq221, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(222, (uint32_t)irq222, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(223, (uint32_t)irq223, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(224, (uint32_t)irq224, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(225, (uint32_t)irq225, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(226, (uint32_t)irq226, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(227, (uint32_t)irq227, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(228, (uint32_t)irq228, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(229, (uint32_t)irq229, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(230, (uint32_t)irq230, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(231, (uint32_t)irq231, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(232, (uint32_t)irq232, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(233, (uint32_t)irq233, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(234, (uint32_t)irq234, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(235, (uint32_t)irq235, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(236, (uint32_t)irq236, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(237, (uint32_t)irq237, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(238, (uint32_t)irq238, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(239, (uint32_t)irq239, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(240, (uint32_t)irq240, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(241, (uint32_t)irq241, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(242, (uint32_t)irq242, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(243, (uint32_t)irq243, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(244, (uint32_t)irq244, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(245, (uint32_t)irq245, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(246, (uint32_t)irq246, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(247, (uint32_t)irq247, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(248, (uint32_t)irq248, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(249, (uint32_t)irq249, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(250, (uint32_t)irq250, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(251, (uint32_t)irq251, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(252, (uint32_t)irq252, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(253, (uint32_t)irq253, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(254, (uint32_t)irq254, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
    idt_set_gate(255, (uint32_t)irq255, GDT_KERNEL_CODE, I86_IDT_ATTR_PRESENT | I86_IDT_ATTR_32BIT_INT_GATE | I86_IDT_ATTR_PRIV_KERNEL);
}

void Arch::idt_install()
{
	ip.size = sizeof(struct idt_entry) * I86_IDT_MAX_ENTRY_COUNT - 1;
	ip.offset = (uint32_t)&idt;
	
	idt_flush();
}
